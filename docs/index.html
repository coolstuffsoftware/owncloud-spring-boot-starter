<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.6.1">
<meta name="author" content="Copyright (c) 2016 by the original Authors">
<title>Owncloud Spring-Boot Starter User Manual</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:initial}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px 0}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:.4em .75em 0 .75em;line-height:1;vertical-align:top}
.colist>table tr>td:first-of-type img{max-width:initial}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Owncloud Spring-Boot Starter User Manual</h1>
<div class="details">
<span id="author" class="author">Copyright (c) 2016 by the original Authors</span><br>
<span id="revnumber">version 1.5.0</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_audience">1. Audience</a></li>
<li><a href="#_changelog">2. Changelog</a>
<ul class="sectlevel2">
<li><a href="#_1_4_0">2.1. 1.4.0</a></li>
</ul>
</li>
<li><a href="#_quick_start">3. Quick Start</a>
<ul class="sectlevel2">
<li><a href="#_maven_dependency">3.1. Maven Dependency</a></li>
<li><a href="#_application_properties">3.2. Application Properties</a></li>
<li><a href="#_test_your_application">3.3. Test your Application</a></li>
</ul>
</li>
<li><a href="#_what_s_included">4. What&#8217;s included</a></li>
<li><a href="#_prerequisites">5. Prerequisites</a></li>
<li><a href="#_configuration">6. Configuration</a>
<ul class="sectlevel2">
<li><a href="#_owncloud_location">6.1. owncloud.location</a></li>
</ul>
</li>
<li><a href="#_authentication">7. Authentication</a>
<ul class="sectlevel2">
<li><a href="#_configuration_2">7.1. Configuration</a></li>
<li><a href="#_rememberme_services">7.2. RememberMe Services</a></li>
<li><a href="#_groups_vs_authorities">7.3. Groups vs. Authorities</a></li>
</ul>
</li>
<li><a href="#_userdetails_service">8. UserDetails Service</a></li>
<li><a href="#_ownclouduserservice">9. OwncloudUserService</a>
<ul class="sectlevel2">
<li><a href="#_creating_a_new_user">9.1. creating a new User</a></li>
<li><a href="#_modifying_a_user">9.2. modifying a User</a></li>
</ul>
</li>
<li><a href="#_owncloudgroupservice">10. OwncloudGroupService</a></li>
<li><a href="#_enable_disable_user_modifications">11. enable/disable User Modifications</a></li>
<li><a href="#_resource_service">12. Resource Service</a>
<ul class="sectlevel2">
<li><a href="#_owncloudresource">12.1. OwncloudResource</a></li>
<li><a href="#_from_owncloudresource_to_owncloudfileresource">12.2. from OwncloudResource to OwncloudFileResource</a></li>
<li><a href="#_relative_super_directory">12.3. relative Super Directory</a></li>
<li><a href="#_local_resource_service">12.4. Local Resource Service</a></li>
<li><a href="#_etag">12.5. eTag</a></li>
<li><a href="#_piped_streams">12.6. piped Streams</a></li>
<li><a href="#_sardine_cache_only_rest_backend">12.7. Sardine Cache (only REST Backend)</a></li>
</ul>
</li>
<li><a href="#_logging">13. Logging</a></li>
<li><a href="#_contributions">14. Contributions</a></li>
<li><a href="#_license">15. License</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_audience">1. Audience</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This Project aims at Developers who wants to enable their SpringBoot Application to be authenticated against an Owncloud Instance and use the Owncloud Provisioning API.</p>
</div>
<div class="paragraph">
<p>It&#8217;s planned to implement the following additional API&#8217;s of Owncloud:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Subadmins (via <a href="https://doc.owncloud.org/server/latest/admin_manual/configuration_user/user_provisioning_api.html">User Provisioning API</a>)</p>
</li>
<li>
<p>App Management (via <a href="https://doc.owncloud.org/server/latest/admin_manual/configuration_user/user_provisioning_api.html">User Provisioning API</a>)</p>
</li>
<li>
<p><a href="https://doc.owncloud.org/server/latest/developer_manual/core/ocs-share-api.html">OCS Share API</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_changelog">2. Changelog</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_1_4_0">2.1. 1.4.0</h3>
<div class="ulist">
<ul>
<li>
<p>BUGFIX: Thread-Deadlock on calling <code>close()</code> twice on <code>PipedInputStream</code> or <code>PipedOutputStream</code></p>
</li>
<li>
<p>UPDATE: updated to Version <code>2.0.3.RELEASE</code> of Spring Boot and other Dependency updates</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_quick_start">3. Quick Start</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_maven_dependency">3.1. Maven Dependency</h3>
<div class="paragraph">
<p>Add the following Maven Dependency:</p>
</div>
<div class="listingblock">
<div class="title">pom.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>software.coolstuff<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>owncloud-spring-boot-starter<span class="tag">&lt;/artifactId&gt;</span>
  <span class="tag">&lt;version&gt;</span>1.5.0<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_application_properties">3.2. Application Properties</h3>
<div class="paragraph">
<p>Add the following Property:</p>
</div>
<div class="listingblock">
<div class="title">application.properties</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="properties">owncloud.location=https://www.example.com/owncloud</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_test_your_application">3.3. Test your Application</h3>
<div class="paragraph">
<p>When you now run your Spring-Boot Application the following Login-Screen appears:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/standard_basic_login_screen.png" alt="Login Screen">
</div>
</div>
<div class="paragraph">
<p>Provide your Owncloud User Credentials and you are now able to work with your Application.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_what_s_included">4. What&#8217;s included</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This Spring-Boot Starter provides the following Functionalities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>simple Auto-Configuration</p>
<div class="ulist">
<ul>
<li>
<p>add it as a Maven Dependency</p>
</li>
<li>
<p>configure the Server-Address as a Spring-Boot Application-Property</p>
</li>
</ul>
</div>
</li>
<li>
<p>Authenticate against one Owncloud Instance by
using the Spring Security Authentication Mechanism</p>
</li>
<li>
<p>Get Information about the authenticated User</p>
</li>
<li>
<p>Modify the granted Authorities during the Authentication Process</p>
</li>
<li>
<p>Get User Information (Display-Name, eMail) of the authenticated User</p>
</li>
<li>
<p>Modify the User Information (Display-Name, eMail) of the authenticated User</p>
</li>
<li>
<p>Get the assigned Groups of the authenticated User</p>
</li>
<li>
<p>additional Enhancements as an Administrator:</p>
<div class="ulist">
<ul>
<li>
<p>Query all Users of the Owncloud Instance (optional with Filter by DisplayName)</p>
</li>
<li>
<p>Query all Groups of the Owncloud Instance (optional with Filter by Group Name)</p>
</li>
<li>
<p>Get detailed Information about one User by its Username</p>
</li>
<li>
<p>Modify the User Information of any User</p>
</li>
<li>
<p>Create new Users</p>
</li>
<li>
<p>Delete Users</p>
</li>
<li>
<p>Get the Group Memberships of any User</p>
</li>
<li>
<p>Modify the Group Memberships of any User</p>
</li>
<li>
<p>Get the User Memberships of any Group</p>
</li>
<li>
<p>get File Quota Information about any User</p>
</li>
</ul>
</div>
</li>
<li>
<p>InMemory Owncloud Instance</p>
<div class="ulist">
<ul>
<li>
<p>Read Data as XML from</p>
<div class="ulist">
<ul>
<li>
<p>a Classpath Resource (read only) or</p>
</li>
<li>
<p>an external File Resource (read write)</p>
</li>
</ul>
</div>
</li>
<li>
<p>Useful for local Development</p>
</li>
<li>
<p>Useful for Unit Tests / Integration Tests</p>
</li>
</ul>
</div>
</li>
<li>
<p>save any type of File on the Owncloud</p>
</li>
<li>
<p>delete existing Files on the Owncloud</p>
</li>
<li>
<p>create/modify/delete Subdirectories</p>
</li>
<li>
<p>get File Quota Information about the authenticated User</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_prerequisites">5. Prerequisites</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following Prerequisites must be met in Order to work with this Spring-Boot Starter:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Owncloud Instance must be installed, configured and running.</p>
</li>
<li>
<p>The Owncloud Instance must have at least Version 8</p>
</li>
<li>
<p>You must be able to connect to this Owncloud Instance (i.E. Firewall-Settings, Network, &#8230;&#8203;)</p>
</li>
<li>
<p>The <a href="https://doc.owncloud.org/server/9.1/admin_manual/configuration_user/user_provisioning_api.html">Provisioning API</a>
must be enabled</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration">6. Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>All Services of this Spring-Boot Starter will be managed by the following <a href="http://docs.spring.io/spring-boot/docs/1.4.3.RELEASE/reference/htmlsingle/#boot-features-external-config">Configuration Parameters</a>.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 23.0769%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 15.3846%;">
<col style="width: 7.6923%;">
<col style="width: 38.4616%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">available for</th>
<th class="tableblock halign-center valign-top">mandatory</th>
<th class="tableblock halign-left valign-top">Data Type</th>
<th class="tableblock halign-center valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">owncloud.location</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Location of the Owncloud Instance</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">owncloud.user-service.enable-modifications</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Modifications through <code>OwncloudUserService</code> and <code>OwncloudGroupService</code> are allowed/disallowed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">owncloud.resource-service.add-relative-down-path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">add <code>..</code> to the List of available Owncloud-Resource within a Directory</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">owncloud.resource-service.piped-stream-buffer-size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">8192</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Buffer Size (in Bytes) for Content-Streaming (InputStream/OutputStream)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">owncloud.resource-service.piped-stream-uncaught-exception-log-level</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LogLevel</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>error</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Log Level for any uncaught Exceptions while Content-Streaming</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">owncloud.resource-service.sardine-cache.concurrency-level</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Concurrency Level for the Sardine Cache (look at <a href="https://google.github.io/guava/releases/23.0/api/docs/com/google/common/cache/CacheBuilder.html#concurrencyLevel-int-">Guava CacheBuilder <code>concurrencyLevel</code></a>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">owncloud.resource-service.sardine-cache.expire-after-access</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Long</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Duration of Availability of the cached Sardine-Implementation after the last Access (see <a href="https://google.github.io/guava/releases/23.0/api/docs/com/google/common/cache/CacheBuilder.html#expireAfterAccess-long-java.util.concurrent.TimeUnit-">Guava CacheBuilder <code>expireAfterAccess</code></a>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">owncloud.resource-service.sardine-cache.expire-after-access-time-unit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.util.concurrent.TimeUnit</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">TimeUnit.SECONDS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Timeunit for <code>owncloud.resource-service.sardine-cache.expire-after-access</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">owncloud.resource-service.sardine-cache.expire-after-write</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Long</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Duration of Availability of the cached Sardine-Implementation after Write (see <a href="https://google.github.io/guava/releases/23.0/api/docs/com/google/common/cache/CacheBuilder.html#expireAfterWrite-long-java.util.concurrent.TimeUnit-">Guava CacheBuilder <code>expireAfterWrite</code></a>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">owncloud.resource-service.sardine-cache.expire-after-write-time-unit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.util.concurrent.TimeUnit</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">TimeUnit.SECONDS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Timeunit for <code>owncloud.resource-service.sardine-cache.expire-after-write</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">owncloud.resource-service.sardine-cache.initial-capacity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Initial Capacity of the Sardine Cache (see <a href="https://google.github.io/guava/releases/23.0/api/docs/com/google/common/cache/CacheBuilder.html#initialCapacity-int-">Guava CacheBuilder <code>initialCapacity</code></a>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">owncloud.resource-service.sardine-cache.maximum-size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Long</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum Size of the Sardine Cache (see <a href="https://google.github.io/guava/releases/23.0/api/docs/com/google/common/cache/CacheBuilder.html#maximumSize-long-">Guava CacheBuilder <code>maximumSize</code></a>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">owncloud.resource-service.sardine-cache.maximum-weight</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Long</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum Weight of the Entries within the Sardine Cache (see <a href="https://google.github.io/guava/releases/23.0/api/docs/com/google/common/cache/CacheBuilder.html#maximumWeight-long-">Guava CacheBuilder <code>maximumWeight</code></a>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">owncloud.resource-service.sardine-cache.refresh-after-write</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Long</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Duration when the Entries of the Sardine-Cache should be refreshed after Write (see <a href="https://google.github.io/guava/releases/23.0/api/docs/com/google/common/cache/CacheBuilder.html#refreshAfterWrite-long-java.util.concurrent.TimeUnit-">Guava CacheBuilder <code>refreshAfterWrite</code></a>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">owncloud.resource-service.sardine-cache.refresh-after-write-time-unit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.util.concurrent.TimeUnit</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">TimeUnit.SECONDS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Timeunit for <code>owncloud.resource-service.sardine-cache.refresh-after-write</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">owncloud.resource-service.message-digest-algorithm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LOCAL</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OwncloudLocalProperties.ResourceServiceProperties.MessageDigestAlgorithm</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">MessageDigestAlgorithm.MD5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Message Digest Algorithm for the Checksum Service</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">owncloud.resource-service.location</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LOCAL</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.nio.file.Path</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Root-Path of the local Files to be served by the <code>OwncloudResourceService</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">owncloud.resource-service.piped-stream-temporary-file-prefix</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LOCAL</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">owncloud</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">File Prefix used for temporary Files by <code>PipedInputStream</code> and <code>PipedOutputStream</code></p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="_owncloud_location">6.1. owncloud.location</h3>
<div class="paragraph">
<p>The Configuration Parameter <code>owncloud.location</code> defines, which Backend will be used.</p>
</div>
<div class="paragraph">
<p>It can have one of the following Values:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 83.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">starts with</th>
<th class="tableblock halign-center valign-top">modifiable</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>http://</code><br>
  <code>https://</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Authentication uses the Owncloud of this Web-Address<br>
                         i.E.: <code>https://www.example.com/owncloud</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>classpath:</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get Data of an In-Memory Owncloud Instance from a Classpath Resource</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>file:</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get Data of an In-Memory Owncloud Instance from an external File Resource</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Normally you would provide the Web-Address of the Owncloud-Instance.
But for local Development or Tests it could be useful, to have an Owncloud Instance which
always behaves the same (returns the same Users, the same Groups, &#8230;&#8203;).</p>
</div>
<div class="paragraph">
<p>There you can define a XML-Resource with either <code>classpath:</code> or <code>file:</code>.<br>
This XML-Resource should have the following Format:</p>
</div>
<div class="listingblock">
<div class="title">owncloud.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;owncloud&gt;</span>
  <span class="tag">&lt;users&gt;</span> <b class="conum">(1)</b>
    <span class="tag">&lt;user&gt;</span> <b class="conum">(2)</b>
      <span class="tag">&lt;username&gt;</span>user1<span class="tag">&lt;/username&gt;</span> <b class="conum">(3)</b>
      <span class="tag">&lt;password&gt;</span>s3cr3t<span class="tag">&lt;/password&gt;</span> <b class="conum">(4)</b>
      <span class="tag">&lt;enabled&gt;</span>true<span class="tag">&lt;/enabled&gt;</span>

      <span class="tag">&lt;displayname&gt;</span>Mr. User 1<span class="tag">&lt;/displayname&gt;</span> <b class="conum">(5)</b>
      <span class="tag">&lt;email&gt;</span>user1@example.com<span class="tag">&lt;/email&gt;</span>

      <span class="tag">&lt;groups&gt;</span> <b class="conum">(6)</b>
        <span class="tag">&lt;group&gt;</span>group1<span class="tag">&lt;/group&gt;</span>
        <span class="tag">&lt;group&gt;</span>group2<span class="tag">&lt;/group&gt;</span>
      <span class="tag">&lt;/groups&gt;</span>

      <span class="tag">&lt;quota&gt;</span>10240<span class="tag">&lt;/quota&gt;</span> <b class="conum">(7)</b>
    <span class="tag">&lt;/user&gt;</span>
    <span class="tag">&lt;user&gt;</span>
      <span class="tag">&lt;username&gt;</span>user2<span class="tag">&lt;/username&gt;</span>
      <span class="tag">&lt;password&gt;</span>s3cr3t<span class="tag">&lt;/password&gt;</span>
      <span class="tag">&lt;enabled&gt;</span>false<span class="tag">&lt;/enabled&gt;</span>
      <span class="tag">&lt;displayName&gt;</span>Mrs. User 2<span class="tag">&lt;/displayName&gt;</span>
      <span class="tag">&lt;email&gt;</span>user2@example.com<span class="tag">&lt;/email&gt;</span>
    <span class="tag">&lt;/user&gt;</span>
  <span class="tag">&lt;/users&gt;</span>

  <span class="tag">&lt;groups&gt;</span> <b class="conum">(8)</b>
    <span class="tag">&lt;group&gt;</span>group1<span class="tag">&lt;/group&gt;</span>
    <span class="tag">&lt;group&gt;</span>group2<span class="tag">&lt;/group&gt;</span>
    <span class="tag">&lt;group&gt;</span>group3<span class="tag">&lt;/group&gt;</span>
  <span class="tag">&lt;/groups&gt;</span>
<span class="tag">&lt;/owncloud&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>List of all existing Users</p>
</li>
<li>
<p>The Definition of a single User</p>
</li>
<li>
<p>Username, Password and Availability-Stats (<code>&lt;enabled&gt;</code>) are mandatory.</p>
</li>
<li>
<p>unencrypted Password (because you&#8217;re in local Development or Test Environment)</p>
</li>
<li>
<p>optional Parameters</p>
</li>
<li>
<p>Group Memberships of the User.</p>
</li>
<li>
<p>File Quota of the User (in Bytes). If omitted the User has unlimited Quota on the File-System.</p>
</li>
<li>
<p>All available Groups of the InMemory Owncloud Instance</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
All Groups, which are referenced as a User-Membership will be checked
      when the Service starts.<br>
      If there are any Groups, which are not defined at the <code>&lt;groups&gt;</code> Section
      the Service will <strong>fail on Startup</strong> with an <code>IllegalStateException</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>So if you define the Configuration Parameter <code>owncloud.location</code> either as</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>classpath:/path/to/owncloud.xml</code> or</p>
</li>
<li>
<p><code>file:/path/to/owncloud.xml</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>the Data of the provided XML-File will be read on Application Startup and resist as a
InMemory Representation used by the Services of this Spring-Boot Starter
(Authentication, UserQuery, UserModification, &#8230;&#8203;).</p>
</div>
<div class="paragraph">
<p>When you use a <code>file:</code> Resource the changed Data will be rewritten to this Resource on a normal Shutdown
of the Application. This is useful for incremental Integration Tests.</p>
</div>
<div class="paragraph">
<p>When you use a <code>classpath:</code> Resource the changed Data will not be written. Therefor this type should be used
for local Development and/or Unit Tests.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_authentication">7. Authentication</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Authentication has been implemented as a Spring Security <a href="http://docs.spring.io/spring-security/site/docs/4.2.1.RELEASE/apidocs/org/springframework/security/authentication/AuthenticationProvider.html"><code>AutheticationProvider</code></a>.<br>
Due to the <a href="http://docs.spring.io/spring-boot/docs/1.4.3.RELEASE/reference/htmlsingle/#using-boot-auto-configuration"><code>AutoConfiguration</code></a> Feature this AuthenticationProvider will be automatically loaded and configured when the Configuration Parameter <code>owncloud.location</code> has been set.</p>
</div>
<div class="sect2">
<h3 id="_configuration_2">7.1. Configuration</h3>
<div class="paragraph">
<p>By including <code>owncloud-spring-boot-starter</code> into the Classpath this Authentication-Provider is autoconfigured unless you decide to Overwrite it (by instantiating your own Implementation as a Subclass of <code>OwncloudAuthenticationProvider</code>).</p>
</div>
<div class="paragraph">
<p>If this is the only Authentication-Provider existing then Spring-Boot will use this Authentication-Provider.</p>
</div>
<div class="paragraph">
<p>When you have several Authentication-Provider instantiated then you have to configure its Usage by a <a href="http://docs.spring.io/spring-security/site/docs/4.2.1.RELEASE/apidocs/org/springframework/security/config/annotation/web/configuration/WebSecurityConfigurerAdapter.html"><code>WebSecurityConfigurerAdapter</code></a></p>
</div>
<div class="listingblock">
<div class="title">WebSecurityConfigurerAdapter</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.springframework.beans.factory.annotation.Autowired</span>;
<span class="keyword">import</span> <span class="include">org.springframework.beans.factory.annotation.Qualifier</span>;
<span class="keyword">import</span> <span class="include">org.springframework.security.authentication.AuthenticationProvider</span>;
<span class="keyword">import</span> <span class="include">org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder</span>;
<span class="keyword">import</span> <span class="include">org.springframework.security.config.annotation.web.configuration.EnableWebSecurity</span>;
<span class="keyword">import</span> <span class="include">org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter</span>;

<span class="annotation">@EnableWebSecurity</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyWebSecurityConfigurerAdapter</span> <span class="directive">extends</span> WebSecurityConfigurerAdapter {

  <span class="annotation">@Autowired</span>
  <span class="annotation">@Qualifier</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">owncloudAuthenticationProvider</span><span class="delimiter">&quot;</span></span>)
  <span class="directive">private</span> AuthenticationProvider authenticationProvider;

  <span class="annotation">@Override</span>
  <span class="directive">protected</span> <span class="type">void</span> configure(AuthenticationManagerBuilder auth) <span class="directive">throws</span> <span class="exception">Exception</span> {
    auth.authenticationProvider(authenticationProvider);
  }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>By the Qualifier <code>owncloudAuthenticationProvider</code> you can inject the Owncloud Authentication Provider directly into the <code>WebSecurityConfigurerAdapter</code> and use this AuthenticationProvider for Authentication.</p>
</div>
</div>
<div class="sect2">
<h3 id="_rememberme_services">7.2. RememberMe Services</h3>
<div class="paragraph">
<p>Unfortunatly RememberMe Service is not available for Owncloud Authentication. Like Microsoft ActiveDirectory the Owncloud Instance doesn&#8217;t provide the Password of a User which is necessary for InMemory RememberMe Services.<br>
Also the RememberMe-Services based on Persistent Tokens will not work because you need the Password of the Owncloud User for all Requests to the Owncloud. This could only be provided, if the original Session is available
(and not reauthenticated by the RememberMe Service).</p>
</div>
<div class="paragraph">
<p>Maybe one time Owncloud will provide an Application Token or work as a OAuth Provider. But this will be future work.</p>
</div>
</div>
<div class="sect2">
<h3 id="_groups_vs_authorities">7.3. Groups vs. Authorities</h3>
<div class="paragraph">
<p>A Group in Owncloud is mostly a Summary of Privileges the User has been granted to (Shares, Calendars, Addressbooks, &#8230;&#8203;)</p>
</div>
<div class="paragraph">
<p>An Authority is, simple said, a Set of Privileges, which you can test upon the Call of a Method.</p>
</div>
<div class="paragraph">
<p>A Owncloud Group wont represent a simple Authority instead a Group of Authorities.</p>
</div>
<div class="paragraph">
<p>Therefor you can map the Groups of the Owncloud User to Authorities needed by your Application in 2 Ways.</p>
</div>
<div class="sect3">
<h4 id="_grantedauthoritiesmapper">7.3.1. GrantedAuthoritiesMapper</h4>
<div class="paragraph">
<p>With the help of a <code>GrantedAuthoritiesMapper</code> you can map the Owncloud Groups of the User to Authorities you can use within your Application. The simplest of them is the <a href="http://docs.spring.io/spring-security/site/docs/4.2.1.RELEASE/apidocs/org/springframework/security/core/authority/mapping/SimpleAuthorityMapper.html"><code>SimpleAuthorityMapper</code></a> which prepends a Prefix <code>ROLE_</code> to the Owncloud Group Name.</p>
</div>
<div class="paragraph">
<p>You simply add the <code>GrantedAuthoritiesMapper</code> as a Spring Bean:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Configuration</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyConfiguration</span> {

  <span class="annotation">@Bean</span>
  <span class="directive">public</span> GrantedAuthoritiesMapper grantedAuthoritiesMapper() {
    <span class="keyword">return</span> <span class="keyword">new</span> SimpleGrantedAuthoritiesMapper();
  }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Up now all Groups of the User will be added with the Prefix <code>ROLE_</code> and added as an Authority to the List of Authorities of the Authentication Object.</p>
</div>
</div>
<div class="sect3">
<h4 id="_owncloudgrantedauthoritiesmapper">7.3.2. OwncloudGrantedAuthoritiesMapper</h4>
<div class="paragraph">
<p>In Spring Security there exists a good <a href="http://docs.spring.io/spring-security/site/docs/current/reference/html/appendix-schema.html">Database Schema</a> for the Relationship between Users, Groups and Authorities:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/diagram-classes.png" alt="diagram classes" width="388" height="152">
</div>
</div>
<div class="paragraph">
<p>Following this Schema there are 2 Kinds of Classes involved</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>User</code>, <code>Group</code> &amp; <code>UserGroup</code> are managed by Owncloud</p>
</li>
<li>
<p><code>Authority</code>, <code>UserAuthority</code> &amp; <code>GroupAuthority</code> are managed by your Application</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>A Spring Bean of <code>OwncloudGrantedAuthoritiesMapper</code> matches your Authorities to the authenticated User during the Authentication Process.</p>
</div>
<div class="listingblock">
<div class="title">MyOwncloudGrantedAuthoritiesMapper.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">java.util.Collection</span>;
<span class="keyword">import</span> <span class="include">java.util.HashSet</span>;
<span class="keyword">import</span> <span class="include">java.util.List</span>;
<span class="keyword">import</span> <span class="include">java.util.Set</span>;

<span class="keyword">import</span> <span class="include">org.apache.commons.collections4.CollectionUtils</span>;
<span class="keyword">import</span> <span class="include">org.apache.commons.lang3.StringUtils</span>;
<span class="keyword">import</span> <span class="include">org.springframework.beans.factory.annotation.Autowired</span>;
<span class="keyword">import</span> <span class="include">org.springframework.security.core.GrantedAuthority</span>;
<span class="keyword">import</span> <span class="include">org.springframework.security.core.authority.SimpleGrantedAuthority</span>;
<span class="keyword">import</span> <span class="include">org.springframework.stereotype.Service</span>;

<span class="keyword">import</span> <span class="include">software.coolstuff.springframework.owncloud.service.api.OwncloudGrantedAuthoritiesMapper</span>;

<span class="annotation">@Service</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyOwncloudGrantedAuthoritiesMapper</span> <span class="directive">implements</span> OwncloudGrantedAuthoritiesMapper {

  <span class="directive">private</span> <span class="directive">final</span> <span class="directive">static</span> <span class="predefined-type">String</span> ROLE_PREFIX = <span class="string"><span class="delimiter">&quot;</span><span class="content">ROLE_</span><span class="delimiter">&quot;</span></span>;

  <span class="annotation">@Autowired</span>
  <span class="directive">private</span> UserAuthorityRepository userAuthorityRepository;

  <span class="annotation">@Autowired</span>
  <span class="directive">private</span> GroupAuthorityRepository groupAuthorityRepository;

  <span class="annotation">@Override</span>
  <span class="directive">public</span> <span class="predefined-type">Collection</span>&lt;? <span class="directive">extends</span> GrantedAuthority&gt; mapAuthorities(
      <span class="predefined-type">String</span> username,
      <span class="predefined-type">Collection</span>&lt;? <span class="directive">extends</span> GrantedAuthority&gt; grantedAuthorities) {
    <span class="predefined-type">Set</span>&lt;GrantedAuthority&gt; authorities = <span class="keyword">new</span> <span class="predefined-type">HashSet</span>&lt;&gt;();

    addAllAuthorities(userAuthorityRepository.getAuthorities(username), authorities);

    <span class="keyword">if</span> (CollectionUtils.isNotEmpty(grantedAuthorities)) {
      <span class="keyword">for</span> (GrantedAuthority grantedAuthority : grantedAuthorities) {
        <span class="predefined-type">List</span>&lt;ApplicationAuthority&gt; groupAuthorities =
          groupAuthorityRepository.getAuthorities(grantedAuthority.getAuthority());
        addAllAuthorities(groupAuthorities, authorities);
      }
    }

    <span class="keyword">return</span> authorities;
  }

  <span class="directive">private</span> <span class="type">void</span> addAllAuthorities(
      <span class="predefined-type">Collection</span>&lt;ApplicationAuthority&gt; applicationAuthorities,
      <span class="predefined-type">Set</span>&lt;GrantedAuthority&gt; springSecurityAuthorities) {
    <span class="keyword">if</span> (CollectionUtils.isEmpty(applicationAuthorities)) {
      <span class="keyword">return</span>;
    }

    <span class="keyword">for</span> (ApplicationAuthority applicationAuthority : applicationAuthorities) {
      GrantedAuthority springSecurityAuthority =
        <span class="keyword">new</span> SimpleGrantedAuthority(applicationAuthority.getName());
      <span class="keyword">if</span> (!StringUtils.startsWith(applicationAuthority.getName(), ROLE_PREFIX)) {
        springSecurityAuthority =
          <span class="keyword">new</span> SimpleGrantedAuthority(ROLE_PREFIX + applicationAuthority.getName());
      }
      springSecurityAuthorities.add(springSecurityAuthority);
    }
  }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>By the assumption that</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Class <code>ApplicationAuthority</code> simply returns the Authority by Method <code>getName()</code></p>
</li>
<li>
<p>Class <code>UserAuthorityRepository</code> returns a List of <code>ApplicationAuthority</code> by Method <code>getAuthorities(String username)</code></p>
</li>
<li>
<p>Class <code>GroupAuthorityRepository</code> returns a List of <code>ApplicationAuthority</code> by Method <code>getAuthorities(String groupname)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>this Class returns all Authorities for the Owncloud User <code>username</code> and its associated Groups (<code>authorities</code>).</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_userdetails_service">8. UserDetails Service</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Like the Authentication Provider the <code>OwncloudUserDetailsService</code> will be autoconfigured by including <code>owncloud-spring-boot-starter</code> into your Classpath.</p>
</div>
<div class="paragraph">
<p>The <code>OwncloudUserDetailsService</code> will be used by <code>OwncloudAuthenticationProvider</code> to load the UserDetails of the authenticated User. This is necessary to identify the Enabled/Disabled Status of the authenticated User.</p>
</div>
<div class="paragraph">
<p>Therefor the <code>OwncloudUserDetails</code> Object will be included into the <code>OwncloudAuthentication</code> Object and will be returned by calling <code>getPrincipal()</code>.</p>
</div>
<div class="paragraph">
<p>Because Owncloud only serves the Enabled/Disabled Status of the User the following Method will always return <code>true</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>isAccountNonExpired()</code></p>
</li>
<li>
<p><code>isAccountNonLocked()</code></p>
</li>
<li>
<p><code>isCredentialsNonExpired()</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Beside the normal Attributes of the Spring Security <a href="http://docs.spring.io/spring-security/site/docs/4.2.1.RELEASE/apidocs/org/springframework/security/core/userdetails/UserDetails.html"><code>UserDetails</code></a> Object the <code>OwncloudUserDetails</code> Object provides the following, additional Fields:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>getDisplayName()</code> &#8230;&#8203; The full Name of the User</p>
</li>
<li>
<p><code>getEmail()</code> &#8230;&#8203; The Email of the User</p>
</li>
<li>
<p><code>getGroups()</code> &#8230;&#8203; A List of Groups the User is a Member of</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ownclouduserservice">9. OwncloudUserService</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When you are authenticated by the Owncloud <code>AuthenticationProvider</code> you can use this Service simply by <code>@Autowire</code> it to your Bean.</p>
</div>
<div class="paragraph">
<p>For more Details about the Owncloud REST-Calls please look at the <a href="https://doc.owncloud.org/server/latest/admin_manual/configuration_user/user_provisioning_api.html">Owncloud User provisioning API</a>.<br></p>
</div>
<div class="paragraph">
<p>The following Methods will be available:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Method</th>
<th class="tableblock halign-left valign-top">Owncloud REST Call</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;String&gt; findAll()</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>GET /ocs/v1.php/cloud/users</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>All Users</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;String&gt; findAll(String filter)</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>GET /ocs/v1.php/cloud/users?search={filter}</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>All Users whose Display Name matches the Search criteria</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Optional&lt;OwncloudUserDetails&gt; findOne(String username)</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>GET /ocs/v1.php/cloud/users/{username}</code><br>
  <code>GET /ocs/v1.php/cloud/users/{username}/groups</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Information about one User</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Full Name</p>
</li>
<li>
<p>Email</p>
</li>
<li>
<p>enabled / disabled</p>
</li>
<li>
<p>all Groups associated to the User</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>OwncloudUserDetails save(OwncloudModificationUser user)</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>additional (when creating a new User):<br>
<code>POST /ocs/v1.php/users -d userid="{username}" -d password="{password}"</code><br></p>
</div>
<div class="paragraph">
<p>modifying User:<br>
<code>PUT /ocs/v1.php/users -d key="display" -d value="{displayName}"</code></p>
</div>
<div class="paragraph">
<p><code>PUT /ocs/v1.php/users -d key="email" -d value="{email}"</code></p>
</div>
<div class="paragraph">
<p>when Groups will be modified:<br>
<code>POST /ocs/v1.php/users/{username}/groups -d groupid="{groupname}"</code></p>
</div>
<div class="paragraph">
<p><code>DELETE /ocs/v1.php/users/{username}/groups -d groupid="{groupname}"</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="ulist">
<ul>
<li>
<p>creates a new User</p>
</li>
<li>
<p>modifies the Information of an existing User</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
due to Security Reasons the Password of a User will not be modified nor will it be returned.
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>void delete(String username)</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>DELETE /ocs/v1.php/users/{username}</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Removes a User from Owncloud</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
all Objects of this User (Files, Calendars, Addressbooks, &#8230;&#8203;) will also be removed.
</td>
</tr>
</table>
</div></div></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="_creating_a_new_user">9.1. creating a new User</h3>
<div class="paragraph">
<p>If you want to create a new User you create a new Instance of <code>OwncloudModificationUser</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">OwncloudModificationUser newUser = OwncloudModificationUser.builder()
  .username(<span class="string"><span class="delimiter">&quot;</span><span class="content">username</span><span class="delimiter">&quot;</span></span>)
  .password(<span class="string"><span class="delimiter">&quot;</span><span class="content">s3cr3t</span><span class="delimiter">&quot;</span></span>)
  .displayName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Display Name of the new User</span><span class="delimiter">&quot;</span></span>)
  .email(<span class="string"><span class="delimiter">&quot;</span><span class="content">user@example.com</span><span class="delimiter">&quot;</span></span>)
  .group(<span class="string"><span class="delimiter">&quot;</span><span class="content">group1</span><span class="delimiter">&quot;</span></span>)
  .group(<span class="string"><span class="delimiter">&quot;</span><span class="content">group2</span><span class="delimiter">&quot;</span></span>)
  .build();
OwncloudUserDetails createdUser =
  owncloudUserModificationService.saveUser(newUser);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_modifying_a_user">9.2. modifying a User</h3>
<div class="paragraph">
<p>If you want to modify the Information about a User this User has to be read just before by
<code>OwncloudUserService.findOne(String username)</code>. With the <code>OwncloudUserDetails</code> Object
in Hands you can create a new <code>OwncloudModificationUser</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">owncloudUserService.findOne(<span class="string"><span class="delimiter">&quot;</span><span class="content">user1</span><span class="delimiter">&quot;</span></span>)
  .map(OwncloudModificationUser::of)
  .map(modificationUser -&gt; {
     modificationUser.setDisplayName(<span class="string"><span class="delimiter">&quot;</span><span class="content">new Display Name of the User</span><span class="delimiter">&quot;</span></span>);
     <span class="keyword">return</span> modificationUser;
   })
  .ifPresent(owncloudUserService::save);</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_owncloudgroupservice">10. OwncloudGroupService</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When you are authenticated by the Owncloud <code>AuthenticationProvider</code> you can use this Service simply by <code>@Autowire</code> it to your Bean.</p>
</div>
<div class="paragraph">
<p>For more Details about the Owncloud REST-Calls please look at the <a href="https://doc.owncloud.org/server/latest/admin_manual/configuration_user/user_provisioning_api.html">Owncloud User provisioning API</a>.<br></p>
</div>
<div class="paragraph">
<p>The following Methods will be available:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 41.6666%;">
<col style="width: 41.6668%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Method</th>
<th class="tableblock halign-left valign-top">Owncloud REST-Call</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;String&gt; findAll()</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>GET /ocs/v1.php/cloud/groups</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>All Groups</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;String&gt; findAll(String filter)</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>GET /ocs/v1.php/cloud/groups?search={filter}</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>All Groups whose Name matches the Search criteria</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;String&gt; findAllUsers(String groupname)</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>GET /ocs/v1.php/cloud/groups/{groupname}</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>All Users associated to the Group</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;String&gt; findAllGroups(String username)</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>GET /ocs/v1.php/cloud/users/{username}/groups</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>All Groups associated to the User</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>void create(String groupname)</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>POST /ocs/v1.php/groups -d groupid="{groupname}"</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Create a new Group</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>void delete(String groupname)`</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>DELETE /ocs/v1.php/groups/{groupname}`</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Removes a Group from Owncloud</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
all Memberships of this Group will also be removed. Also all Shares (Files, Calendars, Addressbooks, &#8230;&#8203;)
</td>
</tr>
</table>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_enable_disable_user_modifications">11. enable/disable User Modifications</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Because Modifications by <code>OwncloudUserService</code> (<code>save</code>, <code>delete</code>) or by <code>OwncloudGroupService</code> (<code>create</code>, <code>delete</code>)
need administrative Privileges of the User there is the Danger, that the Application will remove Users and/or Groups unintentionally.</p>
</div>
<div class="paragraph">
<p>To protect the Usage of <code>OwncloudUserService</code> and <code>OwncloudGroupService</code> can be restricted.<br>
This Restriction is disabled by default.<br>
To deny Modifications by <code>OwncloudUserService</code> and <code>OwncloudGroupService</code> you can set the following Property</p>
</div>
<div class="literalblock">
<div class="content">
<pre>owncloud.enable-modifications=false</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resource_service">12. Resource Service</h2>
<div class="sectionbody">
<div class="paragraph">
<p>One of the main Aspects of Owncloud is the Usage of a centralized WebDAV File Store.
By using the <code>OwncloudResourceService</code> you can interact with this WebDAV-based File Store.</p>
</div>
<div class="paragraph">
<p>Simply by <code>@Autowire</code> the <code>OwncloudResourceService</code> you can use the following Methods:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Method</th>
<th class="tableblock halign-left valign-top">REST-Call</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;OwncloudResource&gt; listRoot()</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>PROPFIND /remote.php/dav/files/{username}/</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Get all Information about Files and/or Directories of the currently authenticated Users Root Directory.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;OwncloudResource&gt; list(URI relativeTo)</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>PROPFIND /remote.php/dav/files/{username}/{relativeTo}</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Get all Information about Files and/or Directories of the given URI.<br>
    This URI is relative to the Root Directory of the currently authenticated User</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Optional&lt;OwncloudResource&gt; find(URI path)</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>PROPFIND /remote.php/dav/files/{username}/{path}</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Find a File or Directory by its URI relative to the Root Directory of the currently authenticated User.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>OwncloudResource createDirectory(URI directory)</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>MKCOL /remote.php/dav/files/{username}/{directory}</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Create a Directory relative to the Root Directory of the currently authenticated User</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>void delete(OwncloudResource resource)</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>DELETE /remote.php/dav/files/{username}/{resource.href}</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Delete a File or Directory referenced by the <code>OwncloudResource</code> (either returned by <code>listRoot()</code>, <code>list(URI relativeTo)</code>
 or <code>find(URI resource)</code>).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Deleting a Directory causes that also all Files and Subdirectories will be removed recursively.
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>InputStream getInputStream(OwncloudFileResource resource)</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>GET /remote.php/dav/files/{username}/{resource.href}</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>get an <code>InputStream</code> to read the Content of a File</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>OutputStream getOutputStream(OwncloudFileResource resource)</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>PUT /remote.php/dav/files/{username}/{resource.href}</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>get an <code>OutputStream</code> to overwrite/append the Content of an existing File.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>OutputStream getOutputStream(URI path, MediaType mediaType)</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>PUT /remote.php/dav/files/{username}/{path}</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>create a new File and get an <code>OutputStream</code> to write its Content.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>OwncloudQuota getQuota()</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>GET /ocs/v1.php/cloud/users/{username}</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>get the Quota of the actual authenticated User</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="_owncloudresource">12.1. OwncloudResource</h3>
<div class="paragraph">
<p>A <code>OwncloudResource</code> is an abstract Representation of a Resource on the Owncloud.
This Resource can either be a File or a Directory.</p>
</div>
<div class="paragraph">
<p>The following Information is available about this Resource:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Information</th>
<th class="tableblock halign-left valign-top">Datatype</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>href</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>java.net.URI</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>name</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>java.lang.String</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>lastModifiedAt</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>java.time.LocalDateTime</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>mediaType</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>org.springframework.http.MediaType</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>eTag</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>java.lang.String</code></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In the case of a File Representation a <code>OwncloudFileResource</code> as a Subclass of
<code>OwncloudResource</code> will be instantiated. This <code>OwncloudFileResource</code> has the
following additional Information:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Information</th>
<th class="tableblock halign-left valign-top">Datatype</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>contentLength</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>java.lang.Long</code></p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_from_owncloudresource_to_owncloudfileresource">12.2. from OwncloudResource to OwncloudFileResource</h3>
<div class="paragraph">
<p>The Methods <code>listRoot()</code> and <code>list(URI relativeTo)</code> both return a List of <code>OwncloudResource</code>
because the Content of a Directory can either be Files or another Directories (Subdirectories).</p>
</div>
<div class="paragraph">
<p>In the case of a Directory the <code>MediaType</code> of the <code>OwncloudResource</code> is set to <code>httpd/unix-directory</code>.
If you have a File (when <code>MediaType</code> of <code>OwncloudResource</code> is not <code>httpd/unix-directory</code>) you can
convert the <code>OwncloudResource</code> to a <code>OwncloudFileResource</code>. Only with the <code>OwncloudFileResource</code>
you can read or write the Content of this File.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Optional&lt;OwncloudFileResource&gt; fileResource =
  resourceService.find(uri)
                 .filter(OwncloudUtils::isNotDirectory)
                 .map(OwncloudUtils:toOwncloudFileResource);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_relative_super_directory">12.3. relative Super Directory</h3>
<div class="paragraph">
<p>When you call <code>list(URI relativeTo)</code> you will get a List of Files/Directories
of the given URI relative to the User Root. <code>OwncloudResourceService</code> will
give you 2 additional Entries: . (actual Directory) and .. (Parent Directory)</p>
</div>
<div class="paragraph">
<p>If you don&#8217;t want a Reference to the Parent Directory you can set
the Configuration Property <code>owncloud.resource-service.add-relative-down-path</code> to
<code>false</code>. (Default is: <code>true</code>).<br>
After setting this Configuration to <code>false</code> no additional Entriy <code>..</code> with
a Reference to the Parent Directory will be added to the Result of
<code>list(URI relativeTo)</code>.</p>
</div>
<div class="paragraph">
<p>By letting this Configuration Property to its Default Value of <code>true</code> the relative
Link to the Super Directory will be added. The only Exception is the Root-Directory
of the User because you can&#8217;t navigate below to the Root-Directory.</p>
</div>
</div>
<div class="sect2">
<h3 id="_local_resource_service">12.4. Local Resource Service</h3>
<div class="paragraph">
<p>As with the <code>OwncloudUserService</code> and the <code>OwncloudGroupService</code>
you can route the <code>OwncloudResource</code> to use a local Storage instead of
a remote Owncloud Instance. You can use the local Storage for Unit-
and/or Integration-Tests.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Don&#8217;t use the local Storage of the <code>OwncloudResource</code>
to build your own WebDAV Storage. This is not the intent of this Project
and the Developers will not take any responsibility for lost Data.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You use the local Storage by setting the local Implementation and a Path
to the Root Directory for all Users defined by <code>owncloud.xml</code>.</p>
</div>
<div class="listingblock">
<div class="title">application.yml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">owncloud</span>:
  <span class="key">location</span>: <span class="string"><span class="content">classpath:/owncloud.xml</span></span>
  <span class="key">resource-service</span>:
    <span class="key">location</span>: <span class="string"><span class="content">/path/to/files</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A Subdirectory will be created for every User of the <code>owncloud.xml</code> at the
first Time he/she uses any Method of <code>OwncloudResourceService</code>.</p>
</div>
<div class="paragraph">
<p>For Instance: if User <code>jane</code> uses any Method of <code>OwncloudResourceService</code>
a Directory <code>/path/to/files/jane</code> will be created.</p>
</div>
</div>
<div class="sect2">
<h3 id="_etag">12.5. eTag</h3>
<div class="paragraph">
<p>The Owncloud calculates an eTag for every Resource. This eTag will be used
by the Owncloud Client to sync changed Files/Directories.</p>
</div>
<div class="paragraph">
<p>The Local Storage of <code>OwncloudResourceService</code> has a similar eTag Calculation
based on a MessageDigest Algorithm. At the Moment only MD5 will be used.</p>
</div>
<div class="paragraph">
<p>The Checksum of a File will be calculated by its Content. The Checksum of a
Directory will be calculated by recursevly concatinating the Checksum of
all Files within this Directory and its Subdirectories.</p>
</div>
<div class="paragraph">
<p>Everytime the Content of a File changes (either by
<code>OwncloudResourceService.getOutputStream</code> or when any other Process outside
of the Spring-Boot Application changes the Content of the File) the Checksum
will be recalculated.</p>
</div>
<div class="paragraph">
<p>For better Performance the Checksums will be cached. On Application Startup
the Checksum of all Files and Directories under the Path referenced by the Property
<code>owncloud.resource-service.location</code> will be calculated and written to a Java Map.</p>
</div>
<div class="paragraph">
<p>This will take some time and the Application Startup has been locked until
the Calculation has been finished. To keep Unit-Tests fast keep the Number
and Size of Files small.</p>
</div>
</div>
<div class="sect2">
<h3 id="_piped_streams">12.6. piped Streams</h3>
<div class="paragraph">
<p>The API of <code>OwncloudResourceService</code> is simple. Because of its simplicity in the
Background there are some challenges because of deferred Read/Write Operations
(when using the REST Backend).</p>
</div>
<div class="sect3">
<h4 id="_piped_outputstream">12.6.1. piped OutputStream</h4>
<div class="paragraph">
<p>So the Write-Process (<code>OwncloudResourceService.getOutputStream()</code>) <strong>never</strong> will be
called directly on the Files. Instead you (Developer who uses the <code>OwncloudResourceService</code>)
will get one end of a Pipe, the <code>PipedOutputStream</code>. With this OutputStream you can
handle all your Streaming.</p>
</div>
<div class="paragraph">
<p>In the Background there has been started a new Thread who keeps the other end of
the Pipe, the <code>PipedInputStream</code>. All Data written to the <code>PipedOutputStream</code> will
be read by the <code>PipedInputStream</code>. This Background Process handles the Communication
with the deferred Owncloud System. If there are some Errors during the I/O Process
(i.E. the Owncloud will be shutdown or network problems) the Background Process cancels
the Transfer and throws an <code>OwncloudException</code> (either when writing or on close of
the <code>PipedOutputStream</code>).</p>
</div>
<div class="paragraph">
<p>Also the local Implementation of <code>OwncloudResourceService.getOutputStream()</code> uses this
Background Process to first write to a temporary File. Only on <code>close()</code> the temporary
File will be moved to the real Position. The temporary File will be created on the
temporary Path-Location (via <code>Files.createTempFile()</code>). The Prefix of this temporary
File can be customized via the Configuration Property
<code>owncloud.resource-service.piped-stream-temporary-file-prefix</code>.
The Default is: <code>owncloud</code></p>
</div>
<div class="listingblock">
<div class="title">application.yml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">owncloud</span>:
  <span class="key">location</span>: <span class="string"><span class="content">classpath:/owncloud.xml</span></span>
  <span class="key">resource-service</span>:
    <span class="key">location</span>: <span class="string"><span class="content">/path/to/files</span></span>
    <span class="key">piped-stream-temporary-file-prefix</span>: <span class="string"><span class="content">owncloud</span></span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_piped_inputstream">12.6.2. piped InputStream</h4>
<div class="paragraph">
<p>Also the REST-Backend of <code>OwncloudResourceService.getInputStream()</code>
uses the piped Streams to handle the deferred Communication to the
Owncloud.</p>
</div>
<div class="paragraph">
<p>So if you call <code>OwncloudResourceService.getInputStream()</code> then you will
get a <code>PipedInputStream</code>. This Pipe is connected to a Background Thread
which keeps the <code>PipedOutputStream</code>. If there are any Errors during the
deferred Read then an <code>OwncloudException</code> will be thrown.</p>
</div>
<div class="paragraph">
<p>The local Implementation of <code>OwncloudResourceService.getInputStream()</code>
on the other Hand <strong>doesn&#8217;t</strong> use this Synchronization Mechanism. Instead
you will get a <code>FileInputStream</code> with which you can read the Data directly.
Please keep this in mind:</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
the REST-Implementation of <code>OwncloudResourceService.getInputStream()</code>
uses the piped Stream Synchronization Mechanism to handle deferred Exceptions.
The local Implementation returns a <code>FileInputStream</code> to the File <strong>without</strong> the
synchronization Mechanism.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_synchronization_buffer">12.6.3. Synchronization Buffer</h4>
<div class="paragraph">
<p>By the Configuration Parameter <code>owncloud.resource-service.piped-stream-buffer-size</code>
you can manage the Bytes which will be read/write by the piped Stream. The Value is
in Bytes. The Default is 8K (8.192) Bytes.</p>
</div>
<div class="listingblock">
<div class="title">application.yml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">owncloud</span>:
  <span class="key">location</span>: <span class="string"><span class="content">classpath:/owncloud.xml</span></span>
  <span class="key">resource-service</span>:
    <span class="key">location</span>: <span class="string"><span class="content">/path/to/files</span></span>
    <span class="key">piped-stream-buffer-size</span>: <span class="string"><span class="content">8192</span></span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_exceptions_during_background_synchronization">12.6.4. Exceptions during Background Synchronization</h4>
<div class="paragraph">
<p>The Background-Thread will be automatically created (and also destroyed) by
the owncloud-spring-boot-starter. It will be created if you call
<code>OwncloudResourceService.getInputStream()</code> (only REST-Backend) or
<code>OwncloudResourceService.getOutputStream()</code> (REST- and local Backend).
It will be closed if you call <code>close()</code> on either the <code>InputStream</code> or the
<code>OutputStream</code> Object.</p>
</div>
<div class="paragraph">
<p>On any Error during the Background Communication the Background-Thread throws
an Instance of <code>OwncloudException</code> and logs the Exception to SLF4J.
The Log-Level of this uncaught Exception can be handled by the Configuration
Parameter <code>owncloud.resource-service.piped-stream-uncaught-exception-log-level</code>
Any valid SLF4J LogLevel can be served. The Default is <code>LogLevel.ERROR</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sardine_cache_only_rest_backend">12.7. Sardine Cache (only REST Backend)</h3>
<div class="paragraph">
<p>Because the WebDAV Protocol enhances the HTTP Protocol by some Methods (<code>PROPFIND</code>, <code>MKCOL</code>, &#8230;&#8203;)
these Methods are not implemented by the <a href="https://docs.spring.io/spring/docs/4.3.12.RELEASE/spring-framework-reference/htmlsingle/#rest-client-access">Spring RestTemplate</a>.
But <a href="https://github.com/lookfirst/sardine">Sardine</a> is an excellent WebDAV Implementation for Java.
Therefor we use Sardine for these HTTP Enhancements.</p>
</div>
<div class="paragraph">
<p>To keep the Time as short as possible for consecutive WebDAV Operations the Sardine Session
of the authenticated User will be cached and reused as long as the User keep the WebDAV Requests active.</p>
</div>
<div class="paragraph">
<p>This happens by using a <a href="https://github.com/google/guava">Google Guava Cache</a>. The Properties for this Cache
can be maintained by Configuration Properties:</p>
</div>
<div class="listingblock">
<div class="title">application.yml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">owncloud</span>:
  <span class="key">location</span>: <span class="string"><span class="content">classpath:/owncloud.xml</span></span>
  <span class="key">resource-service</span>:
    <span class="key">sardine-cache</span>:
      <span class="key">concurrency-level</span>: <span class="string"><span class="content">6</span></span>
      <span class="key">expire-after-access</span>: <span class="string"><span class="content">5</span></span>
      <span class="key">expire-after-access-time-unit</span>: <span class="string"><span class="content">MINUTES</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For a full List of the Configuration Properties look at <a href="#_configuration">Configuration</a> (available for: REST)</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_logging">13. Logging</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This Project uses <a href="http://www.slf4j.org">SLF4J</a> to produce the Logs.</p>
</div>
<div class="paragraph">
<p>You can disable the Logging by setting the Log-Level of the Package <code>software.coolstuff.springframework.owncloud</code> to <code>off</code>.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>logging.level.software.coolstuff.springframework.owncloud=off</pre>
</div>
</div>
<div class="paragraph">
<p>As an alternative you can set the Log-Level to <code>trace</code> if you would like to get all Rest-Requests:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>logging.level.software.coolstuff.springframework.owncloud=trace</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_contributions">14. Contributions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can fork this Project on <a href="https://github.com/coolstuffsoftware/owncloud-spring-boot-starter">Github</a> and create a Pull Request.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_license">15. License</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This Project is licensed under the <a href="https://www.gnu.org/licenses/gpl-3.0.en.html">GPL 3.0 License</a>.</p>
</div>
<a href="https://github.com/coolstuffsoftware/owncloud-spring-boot-starter"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/e7bbb0521b397edbd5fe43e7f760759336b5e05f/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677265656e5f3030373230302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png"></a>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 1.5.0<br>
Last updated 2020-04-19 16:27:14 CEST
</div>
</div>
</body>
</html>